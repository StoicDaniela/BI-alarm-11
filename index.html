<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BI –ê–ª–∞—Ä–º–∞ –∑–∞ –ê–Ω–æ–º–∞–ª–∏–∏ - Professional Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* Login Screen Styles */
        #loginScreen {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            padding: 40px;
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-title {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
            font-weight: 600;
        }

        .login-subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e1e1;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .auth-link {
            color: #667eea;
            text-decoration: none;
            margin-top: 15px;
            display: inline-block;
        }

        .auth-link:hover {
            text-decoration: underline;
        }

        #authError {
            background: #ff6b6b;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            display: none;
        }

        /* Main App Styles */
        #mainApp {
            display: none;
            min-height: 100vh;
            background: #f5f7fa;
        }

        .header {
            background: white;
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            color: #333;
            font-size: 24px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-details {
            text-align: right;
        }

        #userEmail {
            font-weight: 600;
            color: #333;
        }

        #userRole {
            font-size: 12px;
            color: #666;
            background: #e3f2fd;
            padding: 2px 8px;
            border-radius: 12px;
            margin-top: 2px;
            display: inline-block;
        }

        .nav-container {
            background: white;
            border-bottom: 1px solid #e1e1e1;
        }

        .nav-tabs {
            display: flex;
            list-style: none;
            padding: 0 30px;
        }

        .nav-item {
            margin-right: 30px;
        }

        .nav-link {
            display: block;
            padding: 15px 0;
            color: #666;
            text-decoration: none;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .nav-item.active .nav-link,
        .nav-link:hover {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .container {
            padding: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        /* Dashboard Styles */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .metric {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }

        /* Admin Panel Styles */
        .admin-header {
            background: #ff6b6b;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .admin-header h2 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .table-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e1e1;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 12px;
            margin-right: 5px;
        }

        .btn-danger {
            background: #ff6b6b;
        }

        /* Data Input Tabs */
        .data-input-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #e1e1e1;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab-btn.active,
        .tab-btn:hover {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .data-tab-content {
            display: none;
            padding: 20px 0;
        }

        .data-tab-content.active {
            display: block;
        }

        .form-group label {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
            display: block;
        }

        /* Alert Styles */
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid;
        }

        .alert-critical {
            background: #ffe6e6;
            border-left-color: #ff6b6b;
            color: #c92a2a;
        }

        .alert-warning {
            background: #fff4e6;
            border-left-color: #ffa94d;
            color: #d9480f;
        }

        .alert-info {
            background: #e3f2fd;
            border-left-color: #2196f3;
            color: #1565c0;
        }

        .alert-success {
            background: #e8f5e8;
            border-left-color: #4caf50;
            color: #2e7d32;
        }

        .alert-time {
            font-size: 12px;
            color: #666;
            float: right;
        }

        /* Chart Container */
        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 10px;
            }

            .nav-tabs {
                flex-wrap: wrap;
                padding: 0 15px;
            }

            .nav-item {
                margin-right: 15px;
            }

            .container {
                padding: 15px;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen">
        <div class="login-container">
            <h1 class="login-title">üîî BI –ê–ª–∞—Ä–º–∞ –∑–∞ –ê–Ω–æ–º–∞–ª–∏–∏</h1>
            <p class="login-subtitle">Professional Edition ‚Ä¢ Secure Access</p>
            
            <div id="authError"></div>
            
            <!-- Login Form -->
            <form id="loginForm">
                <div class="form-group">
                    <input type="email" id="loginEmail" class="form-control" placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –∏–º–µ–π–ª –∞–¥—Ä–µ—Å" required>
                </div>
                <div class="form-group">
                    <input type="password" id="loginPassword" class="form-control" placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –ø–∞—Ä–æ–ª–∞" required>
                </div>
                <button type="button" onclick="login()" class="btn">–í—Ö–æ–¥</button>
                <a href="#" id="showRegister" class="auth-link">–∏–ª–∏ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
            </form>
            
            <!-- Register Form -->
            <form id="registerForm" style="display: none;">
                <div class="form-group">
                    <input type="text" id="registerName" class="form-control" placeholder="–ü—ä–ª–Ω–æ –∏–º–µ" required>
                </div>
                <div class="form-group">
                    <input type="email" id="registerEmail" class="form-control" placeholder="–ò–º–µ–π–ª –∞–¥—Ä–µ—Å" required>
                </div>
                <div class="form-group">
                    <input type="password" id="registerPassword" class="form-control" placeholder="–ü–∞—Ä–æ–ª–∞ (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–∞)" required>
                </div>
                <div class="form-group">
                    <input type="password" id="registerConfirmPassword" class="form-control" placeholder="–ü–æ—Ç–≤—ä—Ä–¥–∏ –ø–∞—Ä–æ–ª–∞" required>
                </div>
                <button type="button" onclick="register()" class="btn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                <a href="#" id="showLogin" class="auth-link">–ò–º–∞–º –∞–∫–∞—É–Ω—Ç? –í—Ö–æ–¥</a>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp">
        <!-- Header -->
        <header class="header">
            <h1>üîî BI –ê–ª–∞—Ä–º–∞ –∑–∞ –ê–Ω–æ–º–∞–ª–∏–∏</h1>
            <div class="user-info">
                <div class="user-details">
                    <div id="userEmail"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d4a1a7b1a694b1acb5b9a4b8b1fab7bbb9">[email&#160;protected]</a></div>
                    <div id="userRole">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª</div>
                </div>
                <button onclick="logout()" class="btn" style="width: auto;">–ò–∑—Ö–æ–¥</button>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav-container">
            <ul class="nav-tabs">
                <li class="nav-item active">
                    <a href="#" onclick="showScreen('dashboard')" class="nav-link">üìä Dashboard</a>
                </li>
                <li class="nav-item">
                    <a href="#" onclick="showScreen('alerts')" class="nav-link">üö® –ê–ª–∞—Ä–º–∏</a>
                </li>
                <li class="nav-item">
                    <a href="#" onclick="showScreen('analysis')" class="nav-link">üìà –ê–Ω–∞–ª–∏–∑</a>
                </li>
                <li class="nav-item">
                    <a href="#" onclick="showScreen('settings')" class="nav-link">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
                </li>
                <li class="nav-item" id="adminNavBtn" style="display: none;">
                    <a href="#" onclick="showAdminPanel()" class="nav-link">üëë –ê–¥–º–∏–Ω</a>
                </li>
            </ul>
        </nav>

        <!-- Main Content Container -->
        <div class="container">
            <!-- Dashboard Screen -->
            <div id="dashboard" class="screen active">
                <h2>üìä Dashboard</h2>
                
                <!-- Main Metrics -->
                <div class="dashboard-grid">
                    <div class="card">
                        <h3>üö® –ê–∫—Ç–∏–≤–Ω–∏ –ê–ª–∞—Ä–º–∏</h3>
                        <div class="metric" style="color: #ff6b6b;">3</div>
                        <p>1 –∫—Ä–∏—Ç–∏—á–Ω–∞, 2 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</p>
                        <small style="color: #666;">–ü–æ—Å–ª–µ–¥–Ω–∞: –ø—Ä–µ–¥–∏ 15 –º–∏–Ω</small>
                    </div>
                    <div class="card">
                        <h3>üìä –ê–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ –î–∞–Ω–Ω–∏</h3>
                        <div class="metric">2,847</div>
                        <p>–ó–∞–ø–∏—Å–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ –¥–Ω–µ—Å</p>
                        <small style="color: #4caf50;">‚Üë +12% —Å–ø—Ä—è–º–æ –≤—á–µ—Ä–∞</small>
                    </div>
                    <div class="card">
                        <h3>üéØ –°–∏—Å—Ç–µ–º–µ–Ω –°—Ç–∞—Ç—É—Å</h3>
                        <div class="metric" style="color: #4CAF50;">‚úì</div>
                        <p>–í—Å–∏—á–∫–æ —Ä–∞–±–æ—Ç–∏ –Ω–æ—Ä–º–∞–ª–Ω–æ</p>
                        <small style="color: #666;">Uptime: 99.8%</small>
                    </div>
                    <div class="card">
                        <h3>‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç</h3>
                        <div class="metric">4.2–º</div>
                        <p>–°—Ä–µ–¥–Ω–æ –≤—Ä–µ–º–µ –∑–∞ –¥–µ—Ç–µ–∫—Ü–∏—è</p>
                        <small style="color: #4caf50;">‚Üì -0.8–º –ø–æ–¥–æ–±—Ä–µ–Ω–∏–µ</small>
                    </div>
                </div>

                <!-- Real-time Data -->
                <div class="card">
                    <h3>üìà –†–µ–∞–ª–Ω–æ –≤—Ä–µ–º–µ - –ö–ª—é—á–æ–≤–∏ –ú–µ—Ç—Ä–∏–∫–∏</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 15px;">
                        <div style="text-align: center; padding: 15px; background: #fff3cd; border-radius: 8px; border: 2px solid #ffc107;">
                            <h4>üí∞ –ü—Ä–æ–¥–∞–∂–±–∏ (–¥–Ω–µ—Å)</h4>
                            <div style="font-size: 28px; color: #ff6b6b; margin: 10px 0;">2,340 –ª–≤</div>
                            <p style="color: #ff6b6b;">‚Üì -45% —Å–ø—Ä—è–º–æ –≤—á–µ—Ä–∞</p>
                            <small>–¶–µ–ª–µ–≤–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç: 4,200+ –ª–≤</small>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #fff3cd; border-radius: 8px; border: 2px solid #ffc107;">
                            <h4>üåê –¢—Ä–∞—Ñ–∏–∫ (—Å–µ–≥–∞)</h4>
                            <div style="font-size: 28px; color: #ffa94d; margin: 10px 0;">8,920</div>
                            <p style="color: #ffa94d;">‚Üë +78% –Ω–µ–æ–±–∏—á–∞–π–Ω–æ –≤–∏—Å–æ–∫–æ</p>
                            <small>–ù–æ—Ä–º–∞–ª–µ–Ω –¥–∏–∞–ø–∞–∑–æ–Ω: 2,000-5,000</small>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #d4edda; border-radius: 8px; border: 2px solid #28a745;">
                            <h4>üè≠ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ (—Å–º—è–Ω–∞)</h4>
                            <div style="font-size: 28px; color: #28a745; margin: 10px 0;">1,847</div>
                            <p style="color: #28a745;">‚úì –í –Ω–æ—Ä–º–∞</p>
                            <small>–î–µ—Ñ–µ–∫—Ç–∏: 12% (–Ω–∞–¥ –Ω–æ—Ä–º–∞ 5%)</small>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="card">
                        <h3>üîî –ü–æ—Å–ª–µ–¥–Ω–∏ –°—ä–±–∏—Ç–∏—è</h3>
                        <div style="max-height: 200px; overflow-y: auto;">
                            <div style="padding: 8px 0; border-bottom: 1px solid #eee;">
                                <span style="color: #ff6b6b;">üî¥</span> <strong>14:25</strong> - –ö—Ä–∏—Ç–∏—á–µ–Ω —Å–ø–∞–¥ –≤ –ø—Ä–æ–¥–∞–∂–±–∏—Ç–µ
                            </div>
                            <div style="padding: 8px 0; border-bottom: 1px solid #eee;">
                                <span style="color: #ffa94d;">üü°</span> <strong>13:15</strong> - –ù–µ–æ–±–∏—á–∞–π–Ω–æ –≤–∏—Å–æ–∫ —Ç—Ä–∞—Ñ–∏–∫ –¥–µ—Ç–µ–∫—Ç–∏—Ä–∞–Ω
                            </div>
                            <div style="padding: 8px 0; border-bottom: 1px solid #eee;">
                                <span style="color: #ffa94d;">üü°</span> <strong>12:30</strong> - –£–≤–µ–ª–∏—á–µ–Ω–∏ –¥–µ—Ñ–µ–∫—Ç–∏ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ—Ç–æ
                            </div>
                            <div style="padding: 8px 0; border-bottom: 1px solid #eee;">
                                <span style="color: #4caf50;">üü¢</span> <strong>11:45</strong> - –°–∏—Å—Ç–µ–º–∞—Ç–∞ —Ä–∞–±–æ—Ç–∏ –Ω–æ—Ä–º–∞–ª–Ω–æ
                            </div>
                            <div style="padding: 8px 0; border-bottom: 1px solid #eee;">
                                <span style="color: #2196f3;">üîµ</span> <strong>10:20</strong> - –ê–Ω–∞–ª–∏–∑ –Ω–∞ –¥–∞–Ω–Ω–∏ –ø—Ä–∏–∫–ª—é—á–µ–Ω
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>üìä –ë—ä—Ä–∑–∞ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                        <table style="width: 100%; font-size: 14px;">
                            <tr>
                                <td>–û–±—â–æ –∞–Ω–æ–º–∞–ª–∏–∏ –¥–Ω–µ—Å:</td>
                                <td><strong style="color: #ff6b6b;">12</strong></td>
                            </tr>
                            <tr>
                                <td>–†–µ—à–µ–Ω–∏ –∞–Ω–æ–º–∞–ª–∏–∏:</td>
                                <td><strong style="color: #4caf50;">9</strong></td>
                            </tr>
                            <tr>
                                <td>–°—Ä–µ–¥–Ω–æ –≤—Ä–µ–º–µ –∑–∞ —Ä–µ—à–µ–Ω–∏–µ:</td>
                                <td><strong>18.5 –º–∏–Ω</strong></td>
                            </tr>
                            <tr>
                                <td>–ù–∞–π-—á–µ—Å—Ç–∞ –∞–Ω–æ–º–∞–ª–∏—è:</td>
                                <td><strong>–°–ø–∞–¥ –≤ –ø—Ä–æ–¥–∞–∂–±–∏</strong></td>
                            </tr>
                            <tr>
                                <td>–¢–æ—á–Ω–æ—Å—Ç –Ω–∞ –∞–ª–≥–æ—Ä–∏—Ç—ä–º–∞:</td>
                                <td><strong style="color: #4caf50;">87.3%</strong></td>
                            </tr>
                            <tr>
                                <td>–°–ª–µ–¥–≤–∞—â–æ —Å–∫–∞–Ω–∏—Ä–∞–Ω–µ:</td>
                                <td><strong>–ø—Ä–µ–¥–∏ 5 –º–∏–Ω</strong></td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card">
                    <h3>‚ö° –ë—ä—Ä–∑–∏ –î–µ–π—Å—Ç–≤–∏—è</h3>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="runImmediateScan()" class="btn" style="width: auto;">üîç –ù–µ–∑–∞–±–∞–≤–Ω–æ —Å–∫–∞–Ω–∏—Ä–∞–Ω–µ</button>
                        <button onclick="showScreen('alerts')" class="btn" style="width: auto;">üö® –í–∏–∂ –≤—Å–∏—á–∫–∏ –∞–ª–∞—Ä–º–∏</button>
                        <button onclick="showScreen('settings')" class="btn" style="width: auto;">‚öôÔ∏è –î–æ–±–∞–≤–∏ –¥–∞–Ω–Ω–∏</button>
                        <button onclick="exportDashboardReport()" class="btn" style="width: auto;">üì§ –ï–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–π –æ—Ç—á–µ—Ç</button>
                    </div>
                </div>
            </div>

            <!-- Alerts Screen -->
            <div id="alerts" class="screen">
                <h2>üö® –ê–ª–∞—Ä–º–∏ –∑–∞ –ê–Ω–æ–º–∞–ª–∏–∏</h2>
                
                <!-- Alert Summary -->
                <div class="dashboard-grid" style="margin-bottom: 30px;">
                    <div class="card">
                        <h3>üî¥ –ö—Ä–∏—Ç–∏—á–Ω–∏</h3>
                        <div class="metric" style="color: #ff6b6b;" id="criticalAlertsCount">3</div>
                        <p>–ò–∑–∏—Å–∫–≤–∞—Ç –Ω–µ–∑–∞–±–∞–≤–Ω–∏ –¥–µ–π—Å—Ç–≤–∏—è</p>
                    </div>
                    <div class="card">
                        <h3>üü° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</h3>
                        <div class="metric" style="color: #ffa94d;" id="warningAlertsCount">7</div>
                        <p>–ò–∑–∏—Å–∫–≤–∞—Ç –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ</p>
                    </div>
                    <div class="card">
                        <h3>üü¢ –†–µ—à–µ–Ω–∏</h3>
                        <div class="metric" style="color: #4caf50;" id="resolvedAlertsCount">24</div>
                        <p>–ü–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 7 –¥–Ω–∏</p>
                    </div>
                </div>

                <!-- Live Alerts -->
                <div class="card">
                    <h3>üîî –ê–∫—Ç–∏–≤–Ω–∏ –ê–ª–∞—Ä–º–∏</h3>
                    <div id="activeAlerts">
                        <div class="alert alert-critical">
                            <strong>üî¥ –ö–†–ò–¢–ò–ß–ù–ê –ê–ù–û–ú–ê–õ–ò–Ø - –ü—Ä–æ–¥–∞–∂–±–∏</strong>
                            <span class="alert-time">–ø—Ä–µ–¥–∏ 15 –º–∏–Ω</span><br>
                            –ü—Ä–æ–¥–∞–∂–±–∏—Ç–µ —Å–∞ —Å–ø–∞–¥–Ω–∞–ª–∏ —Å 45% —Å–ø—Ä—è–º–æ –≤—á–µ—Ä–∞. –¢–µ–∫—É—â–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç: 2,340 –ª–≤. (–Ω–æ—Ä–º–∞: 4,200+ –ª–≤.)
                        </div>
                        
                        <div class="alert alert-warning">
                            <strong>üü° –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï - –£–µ–±—Å–∞–π—Ç –¢—Ä–∞—Ñ–∏–∫</strong>
                            <span class="alert-time">–ø—Ä–µ–¥–∏ 1 —á–∞—Å</span><br>
                            –ù–µ–æ–±–∏—á–∞–π–Ω–æ –≤–∏—Å–æ–∫ —Ç—Ä–∞—Ñ–∏–∫: 8,920 –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏/—á–∞—Å (–Ω–æ—Ä–º–∞: 2,000-5,000). –í—ä–∑–º–æ–∂–µ–Ω –ø–∏–∫ –∏–ª–∏ –∞—Ç–∞–∫–∞.
                        </div>
                        
                        <div class="alert alert-warning">
                            <strong>üü° –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï - –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</strong>
                            <span class="alert-time">–ø—Ä–µ–¥–∏ 2 —á–∞—Å–∞</span><br>
                            –£–≤–µ–ª–∏—á–µ–Ω–∏ –¥–µ—Ñ–µ–∫—Ç–∏ –Ω–∞ –ª–∏–Ω–∏—è A: 12% –±—Ä–∞–∫ (–Ω–æ—Ä–º–∞: < 5%). –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏—Ç–µ –Ω–∞ –º–∞—à–∏–Ω–∞—Ç–∞.
                        </div>
                        
                        <div class="alert alert-info">
                            <strong>üîµ –ò–ù–§–û–†–ú–ê–¶–ò–Ø - –°–∏—Å—Ç–µ–º–µ–Ω –°—Ç–∞—Ç—É—Å</strong>
                            <span class="alert-time">–ø—Ä–µ–¥–∏ 3 —á–∞—Å–∞</span><br>
                            –°–∏—Å—Ç–µ–º–∞—Ç–∞ —Ä–∞–±–æ—Ç–∏ –≤ –Ω–æ—Ä–º–∞–ª–Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏. –í—Å–∏—á–∫–∏ –º–æ–¥—É–ª–∏ —Å–∞ –∞–∫—Ç–∏–≤–Ω–∏.
                        </div>
                    </div>
                </div>

                <!-- Alert History -->
                <div class="card">
                    <h3>üìú –ò—Å—Ç–æ—Ä–∏—è –Ω–∞ –ê–ª–∞—Ä–º–∏ (–ü–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 24 —á–∞—Å–∞)</h3>
                    <div id="alertHistory">
                        <table style="width: 100%; margin-top: 15px;">
                            <thead>
                                <tr>
                                    <th>–í—Ä–µ–º–µ</th>
                                    <th>–¢–∏–ø</th>
                                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                    <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>14:25</td>
                                    <td><span style="color: #ff6b6b;">üî¥ –ö—Ä–∏—Ç–∏—á–Ω–∞</span></td>
                                    <td>–ü—Ä–æ–¥–∞–∂–±–∏</td>
                                    <td>–°–ø–∞–¥ —Å 45%</td>
                                    <td><span style="color: #ff9800;">–ê–∫—Ç–∏–≤–Ω–∞</span></td>
                                </tr>
                                <tr>
                                    <td>13:15</td>
                                    <td><span style="color: #ffa94d;">üü° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</span></td>
                                    <td>–¢—Ä–∞—Ñ–∏–∫</td>
                                    <td>–í–∏—Å–æ–∫ —Ç—Ä–∞—Ñ–∏–∫</td>
                                    <td><span style="color: #ff9800;">–ê–∫—Ç–∏–≤–Ω–∞</span></td>
                                </tr>
                                <tr>
                                    <td>12:30</td>
                                    <td><span style="color: #ffa94d;">üü° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</span></td>
                                    <td>–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</td>
                                    <td>–£–≤–µ–ª–∏—á–µ–Ω–∏ –¥–µ—Ñ–µ–∫—Ç–∏</td>
                                    <td><span style="color: #ff9800;">–ê–∫—Ç–∏–≤–Ω–∞</span></td>
                                </tr>
                                <tr>
                                    <td>11:45</td>
                                    <td><span style="color: #4caf50;">üü¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</span></td>
                                    <td>–°–∏—Å—Ç–µ–º–∞</td>
                                    <td>–ù–æ—Ä–º–∞–ª–µ–Ω —Å—Ç–∞—Ç—É—Å</td>
                                    <td><span style="color: #4caf50;">–ü—Ä–∏–∫–ª—é—á–µ–Ω–∞</span></td>
                                </tr>
                                <tr>
                                    <td>10:20</td>
                                    <td><span style="color: #ff6b6b;">üî¥ –ö—Ä–∏—Ç–∏—á–Ω–∞</span></td>
                                    <td>–ü—Ä–æ–¥–∞–∂–±–∏</td>
                                    <td>–°–ø–∞–¥ —Å 30%</td>
                                    <td><span style="color: #4caf50;">–†–µ—à–µ–Ω–∞</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Alert Controls -->
                <div class="card">
                    <h3>üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ê–ª–∞—Ä–º–∏</h3>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="markAllAlertsRead()" class="btn" style="width: auto;">‚úÖ –ú–∞—Ä–∫–∏—Ä–∞–π –≤—Å–∏—á–∫–∏ –∫–∞—Ç–æ –ø—Ä–æ—á–µ—Ç–µ–Ω–∏</button>
                        <button onclick="exportAlerts()" class="btn" style="width: auto;">üì§ –ï–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–π –∞–ª–∞—Ä–º–∏</button>
                        <button onclick="clearOldAlerts()" class="btn" style="width: auto;">üóëÔ∏è –ò–∑—á–∏—Å—Ç–∏ —Å—Ç–∞—Ä–∏ –∞–ª–∞—Ä–º–∏</button>
                        <button onclick="runAnomalyCheck()" class="btn" style="width: auto;">üîç –ü—Ä–æ–≤–µ—Ä–∏ –∑–∞ –∞–Ω–æ–º–∞–ª–∏–∏ —Å–µ–≥–∞</button>
                    </div>
                </div>
            </div>

            <!-- Analysis Screen -->
            <div id="analysis" class="screen">
                <h2>üìà –ê–Ω–∞–ª–∏–∑ –Ω–∞ –î–∞–Ω–Ω–∏</h2>
                
                <!-- Analysis Summary -->
                <div class="dashboard-grid" style="margin-bottom: 30px;">
                    <div class="card">
                        <h3>üìä –û–±—â –¢—Ä–µ–Ω–¥</h3>
                        <div class="metric" style="color: #ff6b6b;">üìâ -12%</div>
                        <p>–°–ø–∞–¥ —Å–ø—Ä—è–º–æ –º–∏–Ω–∞–ª–∏—è –ø–µ—Ä–∏–æ–¥</p>
                    </div>
                    <div class="card">
                        <h3>üéØ –¢–æ—á–Ω–æ—Å—Ç –Ω–∞ –ü—Ä–æ–≥–Ω–æ–∑–∏</h3>
                        <div class="metric" style="color: #4caf50;">87%</div>
                        <p>–°—Ä–µ–¥–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç –ø–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 30 –¥–Ω–∏</p>
                    </div>
                    <div class="card">
                        <h3>‚ö° –í—Ä–µ–º–µ –∑–∞ –î–µ—Ç–µ–∫—Ü–∏—è</h3>
                        <div class="metric" style="color: #2196f3;">4.2–º</div>
                        <p>–°—Ä–µ–¥–Ω–æ –≤—Ä–µ–º–µ –∑–∞ –æ—Ç–∫—Ä–∏–≤–∞–Ω–µ</p>
                    </div>
                    <div class="card">
                        <h3>üìà –ê–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ –¢–æ—á–∫–∏</h3>
                        <div class="metric">2,847</div>
                        <p>–î–∞–Ω–Ω–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ –¥–Ω–µ—Å</p>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="chart-container">
                    <h3>üìä –ì—Ä–∞—Ñ–∏–∫–∏ –Ω–∞ –î–∞–Ω–Ω–∏—Ç–µ (–ü–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 30 –¥–Ω–∏)</h3>
                    <div style="margin-bottom: 20px;">
                        <button class="tab-btn active" onclick="showChart('sales')">üí∞ –ü—Ä–æ–¥–∞–∂–±–∏</button>
                        <button class="tab-btn" onclick="showChart('traffic')">üåê –¢—Ä–∞—Ñ–∏–∫</button>
                        <button class="tab-btn" onclick="showChart('production')">üè≠ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</button>
                        <button class="tab-btn" onclick="showChart('combined')">üìä –ö–æ–º–±–∏–Ω–∏—Ä–∞–Ω–∞</button>
                    </div>
                    
                    <div id="chartArea">
                        <div style="height: 300px; background: linear-gradient(45deg, #f8f9fa, #e9ecef); border: 2px dashed #dee2e6; display: flex; align-items: center; justify-content: center; border-radius: 10px;">
                            <div style="text-align: center;">
                                <div style="font-size: 48px; margin-bottom: 10px;">üìà</div>
                                <h4>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏ –ì—Ä–∞—Ñ–∏–∫–∏</h4>
                                <p>–¢—É–∫ —â–µ —Å–µ –ø–æ–∫–∞–∑–≤–∞—Ç –¥–µ—Ç–∞–π–ª–Ω–∏ –≥—Ä–∞—Ñ–∏–∫–∏ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ<br>—Å –æ–∑–Ω–∞—á–µ–Ω–∏ –∞–Ω–æ–º–∞–ª–∏–∏ –∏ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Statistical Analysis -->
                <div class="card">
                    <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –ê–Ω–∞–ª–∏–∑</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4>üí∞ –ü—Ä–æ–¥–∞–∂–±–∏</h4>
                            <table style="width: 100%; font-size: 14px;">
                                <tr><td>–°—Ä–µ–¥–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç:</td><td><strong>3,845 –ª–≤.</strong></td></tr>
                                <tr><td>–ú–µ–¥–∏–∞–Ω–∞:</td><td>3,760 –ª–≤.</td></tr>
                                <tr><td>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ:</td><td>892 –ª–≤.</td></tr>
                                <tr><td>–ú–∏–Ω. —Å—Ç–æ–π–Ω–æ—Å—Ç:</td><td style="color: #ff6b6b;">1,240 –ª–≤.</td></tr>
                                <tr><td>–ú–∞–∫—Å. —Å—Ç–æ–π–Ω–æ—Å—Ç:</td><td style="color: #4caf50;">7,920 –ª–≤.</td></tr>
                                <tr><td>–ö–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç –Ω–∞ –≤–∞—Ä–∏–∞—Ü–∏—è:</td><td>23.2%</td></tr>
                            </table>
                        </div>
                        <div>
                            <h4>üåê –£–µ–±—Å–∞–π—Ç –¢—Ä–∞—Ñ–∏–∫</h4>
                            <table style="width: 100%; font-size: 14px;">
                                <tr><td>–°—Ä–µ–¥–Ω–∏ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏/–¥–µ–Ω:</td><td><strong>4,230</strong></td></tr>
                                <tr><td>–ú–µ–¥–∏–∞–Ω–∞:</td><td>4,180</td></tr>
                                <tr><td>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ:</td><td>1,045</td></tr>
                                <tr><td>–ú–∏–Ω. –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏:</td><td style="color: #ff6b6b;">1,890</td></tr>
                                <tr><td>–ú–∞–∫—Å. –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏:</td><td style="color: #4caf50;">8,920</td></tr>
                                <tr><td>–†–∞—Å—Ç–µ–∂ —Å–ø—Ä—è–º–æ –º.–º.:</td><td style="color: #4caf50;">+8.5%</td></tr>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Anomaly Patterns -->
                <div class="card">
                    <h3>üîç –ú–æ–¥–µ–ª–∏ –Ω–∞ –ê–Ω–æ–º–∞–ª–∏–∏</h3>
                    <div style="margin-bottom: 15px;">
                        <h4>üïê –í—Ä–µ–º–µ–≤–∏ –ú–æ–¥–µ–ª–∏</h4>
                        <ul style="list-style: none; padding-left: 0;">
                            <li style="margin-bottom: 8px;">üî¥ <strong>–ü–æ–Ω–µ–¥–µ–ª–Ω–∏–∫ —Å—É—Ç—Ä–∏–Ω:</strong> 40% –æ—Ç –∞–Ω–æ–º–∞–ª–∏–∏—Ç–µ —Å–µ –ø–æ—è–≤—è–≤–∞—Ç –º–µ–∂–¥—É 8:00-10:00</li>
                            <li style="margin-bottom: 8px;">üü° <strong>–ü–µ—Ç—ä–∫ —Å–ª–µ–¥–æ–±–µ–¥:</strong> –ü–æ–≤–∏—à–µ–Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç –∑–∞ —Å–ø–∞–¥–æ–≤–µ –≤ —Ç—Ä–∞—Ñ–∏–∫–∞</li>
                            <li style="margin-bottom: 8px;">üü¢ <strong>–°—Ä–µ–¥–∞—Ç–∞ –Ω–∞ –º–µ—Å–µ—Ü–∞:</strong> –ù–∞–π-—Å—Ç–∞–±–∏–ª–µ–Ω –ø–µ—Ä–∏–æ–¥ –∑–∞ –≤—Å–∏—á–∫–∏ –º–µ—Ç—Ä–∏–∫–∏</li>
                        </ul>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <h4>üìä –ö–æ—Ä–µ–ª–∞—Ü–∏–∏</h4>
                        <ul style="list-style: none; padding-left: 0;">
                            <li style="margin-bottom: 8px;">üìà <strong>–ü—Ä–æ–¥–∞–∂–±–∏ ‚Üî –¢—Ä–∞—Ñ–∏–∫:</strong> –ö–æ—Ä–µ–ª–∞—Ü–∏—è 0.78 (—Å–∏–ª–Ω–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª–Ω–∞)</li>
                            <li style="margin-bottom: 8px;">üè≠ <strong>–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ ‚Üî –ö–∞—á–µ—Å—Ç–≤–æ:</strong> –ö–æ—Ä–µ–ª–∞—Ü–∏—è -0.65 (—É–º–µ—Ä–µ–Ω–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–Ω–∞)</li>
                            <li style="margin-bottom: 8px;">üå§Ô∏è <strong>–í—Ä–µ–º–µ—Ç–æ ‚Üî –ü—Ä–æ–¥–∞–∂–±–∏:</strong> –ö–æ—Ä–µ–ª–∞—Ü–∏—è 0.34 (—Å–ª–∞–±–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª–Ω–∞)</li>
                        </ul>
                    </div>
                </div>

                <!-- Predictions -->
                <div class="card">
                    <h3>üîÆ –ü—Ä–æ–≥–Ω–æ–∑–∏</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                        <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <h4>–£—Ç—Ä–µ</h4>
                            <div style="font-size: 24px; color: #ffa94d;">‚ö†Ô∏è</div>
                            <p><strong>–í–Ω–∏–º–∞–Ω–∏–µ:</strong> –û—á–∞–∫–≤–∞–Ω —Å–ø–∞–¥ –≤ –ø—Ä–æ–¥–∞–∂–±–∏—Ç–µ —Å 15-25%</p>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <h4>–¢–∞–∑–∏ —Å–µ–¥–º–∏—Ü–∞</h4>
                            <div style="font-size: 24px; color: #4caf50;">üìà</div>
                            <p><strong>–†—ä—Å—Ç:</strong> –¢—Ä–∞—Ñ–∏–∫—ä—Ç —â–µ —Å–µ —É–≤–µ–ª–∏—á–∏ —Å 12-18%</p>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <h4>–°–ª–µ–¥–≤–∞—â –º–µ—Å–µ—Ü</h4>
                            <div style="font-size: 24px; color: #2196f3;">üéØ</div>
                            <p><strong>–°—Ç–∞–±–∏–ª–Ω–æ:</strong> –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ—Ç–æ –≤ –Ω–æ—Ä–º–∞–ª–Ω–∏ –≥—Ä–∞–Ω–∏—Ü–∏</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Screen -->
            <div id="settings" class="screen">
                <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                
                <!-- Data Sources Configuration -->
                <div class="card">
                    <h3>üìä –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ –ò–∑—Ç–æ—á–Ω–∏—Ü–∏—Ç–µ –Ω–∞ –î–∞–Ω–Ω–∏</h3>
                    <div class="form-group">
                        <label>–ê–∫—Ç–∏–≤–Ω–∏ —Ç–∏–ø–æ–≤–µ –¥–∞–Ω–Ω–∏:</label>
                        <div style="margin-top: 10px;">
                            <label style="display: block; margin-bottom: 5px;">
                                <input type="checkbox" id="enableSales" checked> üí∞ –ü—Ä–æ–¥–∞–∂–±–∏
                            </label>
                            <label style="display: block; margin-bottom: 5px;">
                                <input type="checkbox" id="enableTraffic" checked> üåê –£–µ–±—Å–∞–π—Ç —Ç—Ä–∞—Ñ–∏–∫
                            </label>
                            <label style="display: block; margin-bottom: 5px;">
                                <input type="checkbox" id="enableProduction" checked> üè≠ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–∏ –¥–∞–Ω–Ω–∏
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Anomaly Detection Settings -->
                <div class="card">
                    <h3>üö® –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞ –î–µ—Ç–µ–∫—Ü–∏—è –Ω–∞ –ê–Ω–æ–º–∞–ª–∏–∏</h3>
                    
                    <div class="form-group">
                        <label>–ü—Ä–æ–¥–∞–∂–±–∏ - –ü—Ä–∞–≥–æ–≤–µ –∑–∞ –ê–ª–∞—Ä–º–∞:</label>
                        <div style="display: flex; gap: 10px; margin-top: 5px;">
                            <input type="number" id="salesMinThreshold" class="form-control" placeholder="–ú–∏–Ω. —Å—Ç–æ–π–Ω–æ—Å—Ç" style="width: 48%;">
                            <input type="number" id="salesMaxThreshold" class="form-control" placeholder="–ú–∞–∫—Å. —Å—Ç–æ–π–Ω–æ—Å—Ç" style="width: 48%;">
                        </div>
                        <div style="margin-top: 10px;">
                            <label>–ê–ª–∞—Ä–º–∞ –ø—Ä–∏ –ø—Ä–æ–º—è–Ω–∞ > </label>
                            <input type="number" id="salesChangePercent" class="form-control" placeholder="%" style="width: 80px; display: inline-block;">
                            <span>%</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>–£–µ–±—Å–∞–π—Ç –¢—Ä–∞—Ñ–∏–∫ - –ü—Ä–∞–≥–æ–≤–µ:</label>
                        <div style="display: flex; gap: 10px; margin-top: 5px;">
                            <input type="number" id="trafficMinThreshold" class="form-control" placeholder="–ú–∏–Ω. –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏" style="width: 48%;">
                            <input type="number" id="trafficMaxThreshold" class="form-control" placeholder="–ú–∞–∫—Å. –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏" style="width: 48%;">
                        </div>
                        <div style="margin-top: 10px;">
                            <label>–ê–ª–∞—Ä–º–∞ –ø—Ä–∏ –ø—Ä–æ–º—è–Ω–∞ > </label>
                            <input type="number" id="trafficChangePercent" class="form-control" placeholder="%" style="width: 80px; display: inline-block;">
                            <span>%</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ - –ü—Ä–∞–≥–æ–≤–µ:</label>
                        <div style="display: flex; gap: 10px; margin-top: 5px;">
                            <input type="number" id="productionMinThreshold" class="form-control" placeholder="–ú–∏–Ω. –µ–¥–∏–Ω–∏—Ü–∏" style="width: 48%;">
                            <input type="number" id="productionMaxThreshold" class="form-control" placeholder="–ú–∞–∫—Å. –µ–¥–∏–Ω–∏—Ü–∏" style="width: 48%;">
                        </div>
                        <div style="margin-top: 10px;">
                            <label>–ê–ª–∞—Ä–º–∞ –ø—Ä–∏ –ø—Ä–æ–º—è–Ω–∞ > </label>
                            <input type="number" id="productionChangePercent" class="form-control" placeholder="%" style="width: 80px; display: inline-block;">
                            <span>%</span>
                        </div>
                    </div>

                    <button onclick="saveAnomalySettings()" class="btn" style="margin-top: 20px;">üíæ –ó–∞–ø–∞–∑–∏ –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </div>

                <!-- Data Input Section -->
                <div class="card">
                    <h3>üìù –í—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ –î–∞–Ω–Ω–∏</h3>
                    
                    <div class="data-input-tabs">
                        <button class="tab-btn active" onclick="showDataTab('sales')">üí∞ –ü—Ä–æ–¥–∞–∂–±–∏</button>
                        <button class="tab-btn" onclick="showDataTab('traffic')">üåê –¢—Ä–∞—Ñ–∏–∫</button>
                        <button class="tab-btn" onclick="showDataTab('production')">üè≠ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</button>
                        <button class="tab-btn" onclick="showDataTab('csv')">üìÅ CSV –ò–º–ø–æ—Ä—Ç</button>
                    </div>

                    <!-- Sales Data Input -->
                    <div id="salesDataInput" class="data-tab-content active">
                        <h4>üí∞ –í—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ –ü—Ä–æ–¥–∞–∂–±–∏</h4>
                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <input type="date" id="salesDate" class="form-control" style="width: 30%;">
                            <input type="number" id="salesAmount" class="form-control" placeholder="–°—É–º–∞ –≤ –ª–≤." style="width: 30%;">
                            <input type="text" id="salesDescription" class="form-control" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" style="width: 30%;">
                            <button onclick="addSalesData()" class="btn" style="width: 10%;">‚ûï</button>
                        </div>
                    </div>

                    <!-- Traffic Data Input -->
                    <div id="trafficDataInput" class="data-tab-content">
                        <h4>üåê –í—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ –¢—Ä–∞—Ñ–∏–∫</h4>
                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <input type="date" id="trafficDate" class="form-control" style="width: 25%;">
                            <input type="number" id="trafficVisitors" class="form-control" placeholder="–ü–æ—Å–µ—Ç–∏—Ç–µ–ª–∏" style="width: 20%;">
                            <input type="number" id="trafficPageViews" class="form-control" placeholder="–ü—Ä–µ–≥–ª–µ–¥–∏" style="width: 20%;">
                            <input type="text" id="trafficSource" class="form-control" placeholder="–ò–∑—Ç–æ—á–Ω–∏–∫" style="width: 25%;">
                            <button onclick="addTrafficData()" class="btn" style="width: 10%;">‚ûï</button>
                        </div>
                    </div>

                    <!-- Production Data Input -->
                    <div id="productionDataInput" class="data-tab-content">
                        <h4>üè≠ –í—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–∏ –î–∞–Ω–Ω–∏</h4>
                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <input type="date" id="productionDate" class="form-control" style="width: 25%;">
                            <input type="number" id="productionUnits" class="form-control" placeholder="–ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏ –µ–¥–∏–Ω–∏—Ü–∏" style="width: 25%;">
                            <input type="number" id="productionDefects" class="form-control" placeholder="–î–µ—Ñ–µ–∫—Ç–∏" style="width: 20%;">
                            <input type="text" id="productionLine" class="form-control" placeholder="–õ–∏–Ω–∏—è" style="width: 20%;">
                            <button onclick="addProductionData()" class="btn" style="width: 10%;">‚ûï</button>
                        </div>
                    </div>

                    <!-- CSV Import -->
                    <div id="csvDataInput" class="data-tab-content">
                        <h4>üìÅ CSV –ò–º–ø–æ—Ä—Ç</h4>
                        <div style="margin-bottom: 15px;">
                            <label>–ò–∑–±–µ—Ä–∏ —Ç–∏–ø –¥–∞–Ω–Ω–∏:</label>
                            <select id="csvDataType" class="form-control" style="width: 200px; display: inline-block; margin-left: 10px;">
                                <option value="sales">üí∞ –ü—Ä–æ–¥–∞–∂–±–∏</option>
                                <option value="traffic">üåê –¢—Ä–∞—Ñ–∏–∫</option>
                                <option value="production">üè≠ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</option>
                            </select>
                        </div>
                        <input type="file" id="csvFileInput" accept=".csv" class="form-control" style="margin-bottom: 10px;">
                        <button onclick="importCSV()" class="btn">üì§ –ò–º–ø–æ—Ä—Ç–∏—Ä–∞–π CSV</button>
                        <div id="csvPreview" style="margin-top: 15px; display: none;">
                            <h5>–ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ:</h5>
                            <div id="csvPreviewContent"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Panel -->
            <div id="adminPanel" class="screen">
                <div class="admin-header">
                    <h2>üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏ –ü–∞–Ω–µ–ª</h2>
                    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –∏ —Å–∏—Å—Ç–µ–º–Ω–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</p>
                </div>
                
                <div class="table-container">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</h3>
                    <table id="usersTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>–ò–º–µ</th>
                                <th>–ò–º–µ–π–ª</th>
                                <th>–†–æ–ª—è</th>
                                <th>–ö–æ–º–ø–∞–Ω–∏—è</th>
                                <th>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</th>
                                <th>–ü–æ—Å–ª–µ–¥–µ–Ω –≤—Ö–æ–¥</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏—Ç–µ —â–µ —Å–µ –∑–∞—Ä–µ–¥—è—Ç –æ—Ç JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="auth.js"></script>
    <script src="data-manager.js"></script>
    <script src="ui-manager.js"></script>
    <script>
        // Navigation function
        function showScreen(screenName) {
            // Hide all screens
            const screens = document.querySelectorAll('.screen');
            screens.forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show selected screen
            const targetScreen = document.getElementById(screenName);
            if (targetScreen) {
                targetScreen.classList.add('active');
            }
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Find and activate correct nav item
            const navLink = document.querySelector(`[onclick*="${screenName}"]`);
            if (navLink && navLink.closest('.nav-item')) {
                navLink.closest('.nav-item').classList.add('active');
            }
        }
        
        // Enhanced showMainApp function for debugging
        console.log('Enhanced showMainApp function loaded');
        
        // Enhanced showAdminPanel function
        function showAdminPanel() {
            showScreen('adminPanel');
            loadUsersTable();
        }

        // Load and display users in admin panel
        function loadUsersTable() {
            const usersTableBody = document.querySelector('#usersTable tbody');
            if (!usersTableBody) return;
            
            const allUsers = Object.values(users);
            
            if (allUsers.length === 0) {
                usersTableBody.innerHTML = '<tr><td colspan="8" style="text-align: center;">–ù—è–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</td></tr>';
                return;
            }
            
            usersTableBody.innerHTML = allUsers.map((user, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td><span style="color: ${user.role === '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' ? '#ff6b6b' : '#4caf50'};">${user.role}</span></td>
                    <td>${user.company || 'N/A'}</td>
                    <td>${user.createdAt ? formatDate(user.createdAt) : 'N/A'}</td>
                    <td>${user.lastLogin ? formatDate(user.lastLogin) : '–ù–∏–∫–æ–≥–∞'}</td>
                    <td>
                        <button onclick="deleteUser('${user.email}')" class="btn btn-sm btn-danger">üóëÔ∏è –ò–∑—Ç—Ä–∏–π</button>
                        <button onclick="toggleUserRole('${user.email}')" class="btn btn-sm" style="background: #ffa94d;">üîÑ –°–º–µ–Ω–∏ —Ä–æ–ª—è</button>
                    </td>
                </tr>
            `).join('');
        }

        // Delete user function
        function deleteUser(userEmail) {
            if (userEmail === currentUser.email) {
                showNotification('‚ùå –ù–µ –º–æ–∂–µ—Ç–µ –¥–∞ –∏–∑—Ç—Ä–∏–µ—Ç–µ —Å–æ–±—Å—Ç–≤–µ–Ω–∏—è —Å–∏ –∞–∫–∞—É–Ω—Ç!', 'error');
                return;
            }
            
            if (confirm(`–°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –∏–∑—Ç—Ä–∏–µ—Ç–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è ${userEmail}?`)) {
                delete users[userEmail];
                localStorage.setItem('biAlarmUsers', JSON.stringify(users));
                loadUsersTable();
                showNotification('‚úÖ –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –µ –∏–∑—Ç—Ä–∏—Ç —É—Å–ø–µ—à–Ω–æ!', 'success');
            }
        }

        // Toggle user role function
        function toggleUserRole(userEmail) {
            if (userEmail === currentUser.email) {
                showNotification('‚ùå –ù–µ –º–æ–∂–µ—Ç–µ –¥–∞ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ —Å–æ–±—Å—Ç–≤–µ–Ω–∞—Ç–∞ —Å–∏ —Ä–æ–ª—è!', 'error');
                return;
            }
            
            const user = users[userEmail];
            if (!user) return;
            
            const newRole = user.role === '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' ? '–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª' : '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä';
            
            if (confirm(`–°–º—è–Ω–∞ –Ω–∞ —Ä–æ–ª—è—Ç–∞ –Ω–∞ ${user.name} –æ—Ç "${user.role}" –Ω–∞ "${newRole}"?`)) {
                user.role = newRole;
                localStorage.setItem('biAlarmUsers', JSON.stringify(users));
                loadUsersTable();
                showNotification(`‚úÖ –†–æ–ª—è—Ç–∞ –Ω–∞ ${user.name} –µ —Å–º–µ–Ω–µ–Ω–∞ –Ω–∞ ${newRole}!`, 'success');
            }
        }
    </script>
</body>
</html>